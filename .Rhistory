ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
theme_void()+
theme(panel.background = element_rect(fill="blue"),
plot.background = element_rect(fill = "green"))
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand(c(0,0)))+
scale_y_continuous(expand(c(0,0)))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expend(c(0,0)))+
scale_y_continuous(expend(c(0,0)))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(limits=expend(c(0,0)))+
scale_y_continuous(limits=expend(c(0,0)))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(limits=expand(c(0,0)))+
scale_y_continuous(limits=expand(c(0,0)))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(lexpand=c(0,0))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(expand=c(0,0))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(expand=c(0,0))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(expand=c(0,0))+
theme_void()+
theme(panel.background = element_rect(fill="red"),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH <-
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
# geom_area(fill=adjustcolor("#428bca", alpha=0.5))+
geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(expand=c(0,0))+
theme_void()+
theme(panel.background = element_blank(),
plot.background = element_rect(fill = "green"),
plot.margin = unit(c(0, 0, 0, 0), "null"))
plot_nb_OH
ggplot(nb_OH_an,aes(x=annees, y=nb_OH)) +
geom_area(fill="#428bca")+
# geom_line(color="#428bca")+
scale_x_continuous(expand=c(0,0))+
scale_y_continuous(expand=c(0,0))+
theme_void()+
theme(panel.background = element_blank(),
plot.background = element_rect(fill = "transparent", color=NA),
plot.margin = unit(c(0, 0, 0, 0), "null"))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
View(nb_fonction_an)
nb_fonction_an$annee <- seq(-25,max(OH_geom$DATE_FIN))
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+26,ncol=2))
colnames(nb_fonction_an) <-c(1:6)
abs(-25)
abs(mon(OH_geom$DATE_FIN))
abs(min(OH_geom$DATE_FIN))
min(OH_geom$DATE_FIN)
abs(min(OH_geom$DATE_DEB))
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
nb_fonction_an$annee <- seq(-25,max(OH_geom$DATE_FIN))
View(nb_fonction_an)
for (n in 1:6){
for (i in 1:nrow(nb_fonction_an)) {
j <- nb_fonction_an[i,]$annee
nb_fonction_an[i,n] <- sum (OH_geom$V_URB==n & OH_geom@data$DATE_DEB<=j & OH_geom$DATE_FIN>=j)
} # remplir cette colonne de la somme des individus ayant cette valeur urbaine et ayant existé dans les bornes données
}
for (n in 1:6){
for (i in 1:nrow(nb_fonction_an)) {
j <- nb_fonction_an[i,]$annee
nb_fonction_an[i,n] <- sum (OH_geom$V_URB==n & OH_geom$DATE_DEB<=j & OH_geom$DATE_FIN>=j)
} # remplir cette colonne de la somme des individus ayant cette valeur urbaine et ayant existé dans les bornes données
}
View(nb_fonction_an)
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
m_fonction_an$v_urb <- as.numeric(m_fonction_an$variable)
m_fonction_an$v_urb <- cut (m_fonction_an$v_urb,
breaks=c(1,2,3,4,5,6,7),
labels=c("1.voirie, aménagement",
"2.structures défensives et militaires",
"3.constructions civiles",
"4.édifices religieux",
"5.lieux d'inhumation",
"6.lieux de commerce, artisanat, production"),
right=FALSE,
include.lowest = TRUE)
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
library(shiny)
library(shinyjs)
library(shinyWidgets)
library(leaflet)
library(RSQLite)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(stringi)
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
library(dplyr)
library(reshape2)
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
m_fonction_an$v_urb <- as.numeric(m_fonction_an$variable)
m_fonction_an$v_urb <- cut (m_fonction_an$v_urb,
breaks=c(1,2,3,4,5,6,7),
labels=c("1.voirie, aménagement",
"2.structures défensives et militaires",
"3.constructions civiles",
"4.édifices religieux",
"5.lieux d'inhumation",
"6.lieux de commerce, artisanat, production"),
right=FALSE,
include.lowest = TRUE)
View(m_fonction_an)
ggplot <- geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4")
ggplot ()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4")
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
nb_fonction_an$annee <- seq(min(OH_geom$DATE_DEB),max(OH_geom$DATE_FIN))
nb_fonction_an$1
nb_fonction_an[['1']]
nb_fonction_an[['1']] <- apply(nb_fonction_an,
MARGIN = 1,
function(x){sum(OH_geom$DATE_DEB<=x$annees & OH_geom$DATE_FIN>=x$annees & OH_geom$V_URB==1)}
)
apply(nb_fonction_an,
function(x){sum(OH_geom$DATE_DEB<=x[['annee']] & OH_geom$DATE_FIN>=x[['annee']] & OH_geom$V_URB==1)}
)
nb_fonction_an[['1']] <-
apply(nb_fonction_an, function(x){sum(OH_geom$DATE_DEB<=x[['annee']] & OH_geom$DATE_FIN>=x[['annee']] & OH_geom$V_URB==1)})
nb_fonction_an[['1']] <-
test <- apply(nb_fonction_an, function(x){sum(OH_geom$DATE_DEB<=x[['annee']] & OH_geom$DATE_FIN>=x[['annee']] & OH_geom$V_URB==1)})
sum(OH_geom$DATE_DEB<=25 & OH_geom$DATE_FIN>=25 & OH_geom$V_URB==1)
nb_fonction_an[['1']] <-
test <- apply(nb_fonction_an, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==1)})
nb_fonction_an[['1']] <-
test <- apply(nb_fonction_an, MAGRIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==1)})
nb_fonction_an[['1']] <-
apply(nb_fonction_an, MARGIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==1)})
apply(nb_fonction_an, MARGIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==1)})
nb_fonction_an[['1']] <- apply(nb_fonction_an, MARGIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==1)})
for (n in 1:6){
nb_fonction_an[[n]] <- apply(nb_fonction_an, MARGIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==n)})
}
View(nb_fonction_an)
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
nb_fonction_an$annee <- seq(min(OH_geom$DATE_DEB),max(OH_geom$DATE_FIN))
for (n in 1:6){
nb_fonction_an[[n]] <- apply(nb_fonction_an, MARGIN = 1, function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==n)})
}
nb_OH_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=2))
colnames(nb_OH_an) <- c("annees", "nb_OH")
nb_OH_an$annees <- seq(min(OH_geom$DATE_DEB),max(OH_geom$DATE_FIN))
nb_OH_an$nb_OH <- apply(nb_OH_an, MARGIN = 1, function(x){sum (OH_geom$DATE_DEB<=x[1] & OH_geom$DATE_FIN>=x[1])})
ggplot(nb_OH_an,
aes(x = annees,
y = nb_OH)) + geom(area)
ggplot(nb_OH_an,
aes(x = annees,
y = nb_OH)) +
geom_area()
ggplot(nb_OH_an, aes(x = annees, y = nb_OH)) +
geom_bar()
nb_OH_an = cbind(nb_OH_an, replicate(5,nb_OH_an$nb_OH))
View(nb_OH_an)
nb_fonction_an$total <- colSums(nb_fonction_an[,1:6])
colSums(nb_fonction_an[,1:6])
nb_fonction_an$total <- rowSums(nb_fonction_an[,1:6])
View(nb_fonction_an)
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
View(m_fonction_an)
ggplot ()+
geom_area(data = nb_OH_an,
aes(x=annee, y=total),
fill="#CDD2D4")
ggplot ()+
geom_area(data = nb_fonction_an,
aes(x=annee, y=total),
fill="#CDD2D4")
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=total),
stat="identity",
width=1,
fill="#CDD2D4") +
View(m_fonction_an)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=total),
stat="identity",
width=1,
fill="#CDD2D4")
ggplot()+
geom_bar(data = nb_fonction_an,
aes(x=annee, y=total),
stat="identity",
width=1,
fill="#CDD2D4")
ggplot ()+
geom_area(data = nb_fonction_an,
aes(x=annee, y=total),
fill="#CDD2D4")
ggplot()+
geom_bar(data = nb_fonction_an,
aes(x=annee, y=total),
stat="identity",
width=1,
fill="#CDD2D4")
ggplot ()+
geom_area(data = m_fonction_an,
aes(x=annee, y=value))
ggplot ()+
geom_area(data = m_fonction_an %>% filter(value=='total'),
aes(x=annee, y=value))
m_fonction_an %>% filter(value=='total')
m_fonction_an
ggplot ()+
geom_area(data = m_fonction_an %>% filter(variable=='total'),
aes(x=annee, y=value))
ggplot ()+
geom_area(data = m_fonction_an %>% filter(variable=='total'),
aes(x=annee, y=value)) +
geom_area(data = m_fonction_an %>% filter(variable!='total'),
aes(x=annee, y=value, fill=variable))+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
facet_wrap(~variable))
ggplot ()+
geom_area(data = m_fonction_an %>% filter(variable=='total'),
aes(x=annee, y=value)) +
geom_area(data = m_fonction_an %>% filter(variable!='total'),
aes(x=annee, y=value, fill=variable))+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
facet_wrap(~variable)
ggplot ()+
# geom_area(data = m_fonction_an %>% filter(variable=='total'),
#                  aes(x=annee, y=value)) +
geom_area(data = m_fonction_an %>% filter(variable!='total'),
aes(x=annee, y=value, fill=variable))+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
facet_wrap(~variable)
ggplot (data = m_fonction_an %>% filter(variable!='total'))+
# geom_area(data = m_fonction_an %>% filter(variable=='total'),
#                  aes(x=annee, y=value)) +
geom_area(aes(x=annee, y=value, fill=variable))+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
facet_wrap(~variable)
m_fonction_an$variable
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
nb_fonction_an$annee <- seq(min(OH_geom$DATE_DEB),max(OH_geom$DATE_FIN))
for (n in 1:6){
nb_fonction_an[[n]] <- apply(nb_fonction_an,
MARGIN = 1,
function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==n)})
}
# nb_fonction_an$total <- rowSums(nb_fonction_an[,1:6])
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
library(shiny)
library(shinyjs)
library(shinyWidgets)
library(leaflet)
library(RSQLite)
library(dplyr)
library(reshape2)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(stringi)
library(shiny)
library(shinyjs)
library(shinyWidgets)
library(leaflet)
library(RSQLite)
library(dplyr)
library(reshape2)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(stringi)
nb_fonction_an <- as.data.frame(matrix(nrow=max(OH_geom$DATE_FIN)+abs(min(OH_geom$DATE_DEB))+1,ncol=6))
colnames(nb_fonction_an) <-c(1:6)
nb_fonction_an$annee <- seq(min(OH_geom$DATE_DEB),max(OH_geom$DATE_FIN))
for (n in 1:6){
nb_fonction_an[[n]] <- apply(nb_fonction_an,
MARGIN = 1,
function(x){sum(OH_geom$DATE_DEB<=x[7] & OH_geom$DATE_FIN>=x[7] & OH_geom$V_URB==n)})
}
# nb_fonction_an$total <- rowSums(nb_fonction_an[,1:6])
m_fonction_an <- melt(nb_fonction_an, id.vars="annee")
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = subset_m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~ v_urb, scales=echelle, nrow=2)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~ v_urb, scales=echelle, nrow=2)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~ v_urb, nrow=2)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~ v_urb, nrow=2)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~variable, nrow=2)
m_fonction_an$annee <- as.numeric(m_fonction_an$annee)
m_fonction_an$variable <- as.numeric(m_fonction_an$variable)
m_fonction_an$value <- as.numeric(m_fonction_an$value)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~variable, nrow=2)
m_fonction_an$variable <- as.factor(m_fonction_an$variable)
ggplot()+
geom_bar(data = m_fonction_an,
aes(x=annee, y=value),
stat="identity",
width=1,
fill="#CDD2D4") +
geom_bar(data = m_fonction_an,
aes(x=annee, y=value, fill=variable),
stat = "identity",
width=1)+
scale_fill_manual(values=adjustcolor(palette, alpha.f=0.8))+
ggtitle("Nombre d'OH par année et par valeur urbaine")+
xlab("année")+
ylab("Nombre d'OH")+
theme_hc()+
theme_facettes_clair()+
facet_wrap(~variable, nrow=2)
install.packages("otvPlots")
shiny::runApp()
runApp()
library('yaml')
install.packages("yaml")
runApp()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
OH_geom$PORTEE
runApp()
