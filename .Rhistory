width=15)+
geom_col(data=disparition_vurb,
aes(x=DATE_FIN, y=-freq, fill=V_URB),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_vurb)+
facet_wrap(~V_URB, ncol=1, scales="free_y",
labeller = as_labeller(labels_vurb))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par valeurs urbaines",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
View(m_nb_OH_vurb)
View(apparition_vurb)
m_nb_OH_vurb %>% mutate(V_URB=stri_sub(variable,1,1) %>% View()
m_nb_OH_vurb %>% mutate(V_URB=stri_sub(variable,1,1))%>% View()
ggplot()+
geom_line(data = m_nb_OH_vurb %>% mutate(V_URB=stri_sub(variable,1,1))%>% View(),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_vurb,
aes(x=DATE_DEB, y=freq,fill=V_URB),
width=15)+
geom_col(data=disparition_vurb,
aes(x=DATE_FIN, y=-freq, fill=V_URB),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_vurb)+
facet_wrap(~V_URB, ncol=1, scales="free_y",
labeller = as_labeller(labels_vurb))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par valeurs urbaines",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_vurb %>% mutate(V_URB=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_vurb,
aes(x=DATE_DEB, y=freq,fill=V_URB),
width=15)+
geom_col(data=disparition_vurb,
aes(x=DATE_FIN, y=-freq, fill=V_URB),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_vurb)+
facet_wrap(~V_URB, ncol=1, scales="free_y",
labeller = as_labeller(labels_vurb))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par valeurs urbaines",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_vurb %>% mutate(V_URB=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
# scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portées",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_vurb %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
# scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portées",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
m_nb_OH_vurb %>% mutate(PORTEE=stri_sub(variable,1,1)) %>% View()
m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)) %>% View()
View(m_nb_OH_portee)
m_nb_OH_portee <- nb_OH_annee %>% select(annee, contains("portee"), -portee_somme) %>% melt(id.vars="annee")
levels(m_nb_OH_portee$variable) <-c("1.portée petite ","2.portée moyenne","3.grande portée","4.portée exceptionnelle")
m_pourc_OH_portee <-  pourc_OH_annee%>% select(annee, contains("portee"), -portee_somme) %>% melt(id.vars="annee")
levels(m_pourc_OH_portee$variable) <-c("1.portée petite ","2.portée moyenne","3.grande portée","4.portée exceptionnelle")
View(m_nb_OH_portee)
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
# scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portées",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portées",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
couleurs_portees
couleurs_vurb
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
# scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portées",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portée",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
)
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee,
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portée",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
View(apparition_portee)
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee %>% mutate(PORTEE=as.factor(PORTEE)),
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee,
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portée",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
ggplot()+
geom_line(data = m_nb_OH_portee %>% mutate(PORTEE=stri_sub(variable,1,1)),
aes(x=annee, y=value),
color="grey60")+
geom_col(data=apparition_portee %>% mutate(PORTEE=as.factor(PORTEE)),
aes(x=DATE_DEB, y=freq,fill=PORTEE),
width=15)+
geom_col(data=disparition_portee%>% mutate(PORTEE=as.factor(PORTEE)),
aes(x=DATE_FIN, y=-freq, fill=PORTEE),
alpha=0.5,
width=15)+
scale_fill_manual(values=couleurs_portees)+
facet_wrap(~PORTEE, ncol=1, scales="free_y",
labeller = as_labeller(labels_portees))+
labs(x="année",
y="nombre d'OH",
title="Rythme d'apparition et de disparition des OH par portée",
caption="L. Nahassia, Géographie-cités, 2019 | Sources : ToToPI, CITERES-LAT"
)+
theme_fivethirtyeight()+
scale_x_continuous(breaks = c(1,seq(200,2000,200)))+
theme_ln()+
theme(strip.text=element_text(hjust = 0))
runApp()
runApp()
View(m_nb_OH_vurb)
View(nb_OH_annee)
View(nb_OH_annee)
OH_subset <- OH_geom
# structure du tableau
nb_vurb_an <-
as.data.frame(matrix(nrow=2015+26,ncol=6))
# structure du tableau
nb_vurb_an <- as.data.frame(matrix(nrow=2015+26,ncol=6))
colnames(nb_vurb_an) <-c(1:6)
View(nb_vurb_an)
colnames(nb_vurb_an) <-c(1:6)
nb_vurb_an$annee <- as.numeric(rownames(nb_vurb_an))-26
for (i in 1:(nrow(nb_vurb_an)+1)) { #pour toutes les lignes
annee <- i-26
nb_vurb_an[i,n] <- sum (OH_subset$v_urb==n & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
} # remplir cette colonne de la somme des individus ayant cette valeur urbaine et ayant existé dans les bornes données
View(OH_subset)
# rownames(nb_vurb_an) <- as.numeric(rownames(nb_vurb_an))-1
#remplissage du tableau
for (n in 1:6){ # pour toutes les colonnes valeurs urbaines existantes
for (i in 1:(nrow(nb_vurb_an)+1)) { #pour toutes les lignes
annee <- i-26
nb_vurb_an[i,n] <- sum (OH_subset$V_URB==n & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
} # remplir cette colonne de la somme des individus ayant cette valeur urbaine et ayant existé dans les bornes données
}
nb_vurb_an <- nb_vurb_an %>%  filter(annee != 0) #enlever l'année 0
nb_vurb_an$somme <- rowSums(nb_vurb_an)-nb_vurb_an$annee #somme
pourc_portee_an <- nb_portee_an %>% mutate_at(vars(-somme, -annee), list(~./somme*100))#en pourcentages
pourc_vurb_an <- nb_vurb_an %>% mutate_at(vars(-somme, -annee), list(~./somme*100))
View(pourc_vurb_an)
m_nb_OH_vurb <- nb_OH_annee %>% select(annee, contains("vurb"), -vurb_somme) %>% melt(id.vars="annee")#melt pour plot sur valeurs absolues
levels(m_nb_OH_vurb$variable) <-liste_vurb
m_pourc_OH_vurb <-  pourc_OH_annee%>% select(annee, contains("vurb"), -vurb_somme) %>% melt(id.vars="annee")#melt pour plot sur valeurs relatives
levels(m_pourc_OH_vurb$variable) <-liste_vurb
tableaux <- list("melt_nb"=m_nb_OH_vurb,"melt_pourc"=)#liste des deux tableaux résultats
tableaux <- list("melt_nb"=m_nb_OH_vurb,"melt_pourc"=m_pourc_OH_vurb)#liste des deux tableaux résultats
View(m_nb_OH_vurb)
rm(nb_OH_annee)
rm(m_nb_OH_portee)
rm(m_nb_OH_vurb)
rm(m_nb_OH_vusage)
rm(m_pourc_OH_vurb)
rm(m_pourc_OH_vusageà
rm(m_pourc_OH_vusage)
rm(m_pourc_OH_portee)
melt(pourc_OH_annee)
rm(pourc_OH_annee)
rm(pourc_vurb_an)
liste_vusage <- unique(OH_subset %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH_subset$V_USAGE==v_usage & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
}
}
liste_vusage <- unique(OH_subset %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH_subset$V_USAGE==v_usage & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
}
}
OH_subset <- OH_geom %>% st_drop_geometry()
OH_subset <- OH_geom %>% st_drop_geometry()
liste_vusage <- unique(OH_subset %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH_subset$V_USAGE==v_usage & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
}
}
OH <- OH_geom %>% st_drop_geometry()
liste_vusage <- unique(OH %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=max(OH$DATE_FIN)+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH$V_USAGE==v_usage & OH$DATE_DEB<=annee & OH$DATE_FIN>=annee)
}
}
View(OH)
OH
liste_vusage <- unique(OH %>% select(V_USAGE)) %>% as_tibble()
OH <- OH_geom %>% st_drop_geometry()%>% as_tibble()
View(OH)
OH
liste_vusage <- unique(OH %>% select(V_USAGE))
liste_vusage
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
nb_usage_an
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
$annee <- as.numeric(rownames(nb_usage_an))-26
nb_usage_an
i<-1
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
v_usage
n<-1
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
annee
v_usage
nb_usage_an[i,n] <- sum (OH$V_USAGE==v_usage & OH$DATE_DEB<=annee & OH$DATE_FIN>=annee)
nb_usage_an
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH$V_USAGE==v_usage & OH$DATE_DEB<=annee & OH$DATE_FIN>=annee)
}
}
runApp()
runApp()
m_nb_usage_an <- nb_usage_an %>%
select(-somme) %>%
melt(id.vars="annee") %>%
mutate(v_urb=stri_sub(variable,-2,-2))
OH_subset <- OH_geom
liste_vusage <- unique(OH_subset %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH_subset$V_USAGE==v_usage & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
}
}
OH_subset <- OH_geom %>% st_drop_geometry()%>% as_tibble()
liste_vusage <- unique(OH_subset %>% select(V_USAGE))
nb_usage_an <- as.data.frame(matrix(nrow=2015+26,ncol=nrow(liste_vusage)))
colnames(nb_usage_an) <- sort(liste_vusage$V_USAGE)
nb_usage_an$annee <- as.numeric(rownames(nb_usage_an))-26
for (n in 1:nrow(liste_vusage)){
for (i in 1:nrow(nb_usage_an)+1) {
annee <- i-26
v_usage <- colnames(nb_usage_an[n])
nb_usage_an[i,n] <- sum (OH_subset$V_USAGE==v_usage & OH_subset$DATE_DEB<=annee & OH_subset$DATE_FIN>=annee)
}
}
nb_usage_an <- nb_usage_an %>%  filter(annee != 0)
nb_usage_an$somme <- rowSums(nb_usage_an)-nb_usage_an$annee
pourc_usage_an <- nb_usage_an %>% mutate_at(vars(-somme, -annee), list(~./somme*100)) #attention au nombre de colonnes
m_nb_usage_an <- nb_usage_an %>%
select(-somme) %>%
melt(id.vars="annee") %>%
mutate(v_urb=stri_sub(variable,-2,-2))
View(m_nb_usage_an)
rm(m_nb_OH_portee)
rm(m_nb_OH_vurb)
rm(m_nb_OH_vusage)
rm(m_pourc_OH_portee)
rm(m_nb_usage_an)
rm(m_nb_usage_an)
rm(m_pourc_OH_vurb)
rm(m_pourc_OH_vusage)
rm(nb_OH_annee)
rm(nb_usage_an)
rm(nb_vurb_an)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
rm(i)
rm(n)
rml(annee)
rm(annee)
View(apparition_vurb)
rm(apparition_portee)
rm(apparition_vurb)
runApp()
shiny::runApp()
#OH pour analyse zone
OH_over_app <- read.csv("./data/OH_over_app.csv", encoding="UTF-8", header=TRUE)
OH_over_app$occupation <- factor(OH_over_app$occupation, levels=c("urbaine", "intermediaire","non urbaine"))
OH_over_app$densite <- factor(OH_over_app$densite, levels=c("3","2","1","0"))
OH_over_exi <-read.csv("./data/OH_over_exi.csv", encoding="UTF-8", header=TRUE)
OH_over_exi$densite <- factor(OH_over_exi$densite, levels=c("3","2","1","0"))
OH_over_exi$OH_NUM <- as.character(OH_over_exi$OH_NUM)
exi_ordre <- OH_over_exi %>% mutate(OH_NUM2 = forcats::fct_reorder(.f = OH_NUM,date_debut_OH)) #ordre pour tableau longitudinal
OH_over_exi$OH_NUM <- as.character(OH_over_exi$OH_NUM)
exi_ordre <- OH_over_exi %>% mutate(OH_NUM2 = forcats::fct_reorder(.f = OH_NUM,date_debut_OH)) #ordre pour tableau longitudinal
exi_transitions <- OH_over_exi %>% #tableau des transitions
select(date_debut, date_fin, date_fin_OH, occupation, densite, OH_NUM, V_USAGE, V_URB, PORTEE) %>%
mutate(date_transition=date_fin, lead_occ =lead(occupation), lead_dens= lead(densite)) %>%
mutate(trans_occ = paste(occupation,"\nà\n", lead_occ, sep=" ") %>% as.factor,trans_dens = paste(densite,"à", lead_dens, sep=" ") %>% as.factor()) %>%
filter(date_fin!=date_fin_OH) %>%
select(date_transition, occupation, lead_occ, trans_occ, densite, lead_dens, trans_dens,OH_NUM, V_USAGE, V_URB, PORTEE)
