geom_text(AFC=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_variable),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(AFC=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(AFC=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(AFC=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(AFC=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)+
#labels variables
geom_text(AFC=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_variable),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(AFC=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(AFC=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(AFC=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
lab_periode <- data$li
lab_periode <- AFC$li
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_variable),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(data=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=list_var),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(data=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_var),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(data=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)
AFC$co[,axe1]
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
)
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
# size=7,
colour=palette)
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
# shape=16,
# size=7,
colour=palette)
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7)
AFC$col
AFC$co
palette$usages <- as.numeric(str_sub(rownames(AFC$co), start=-2))
palette$usages <- as.numeric(str_sub(rownames(AFC$co), start=-2))
as.numeric(str_sub(rownames(AFC$co), start=-2))
usages <- as.numeric(str_sub(rownames(AFC$co), start=-2))
palette$usages <- usages
test$usages <- usages
bl$usages <- usages
usages <- as.numeric(str_sub(rownames(AFC$co), start=-2))
usages <- as.numeric(str_sub(rownames(AFC$co), start=-2))
couleurs_usages <- cut (usages,
breaks=c(10,20,30,40,50,60,70),
labels=c("#e72535", "#0a8eb1", "#f6b01a", "#2fc6a0", "#703ab9","#ff7919"),
right=FALSE,
include.lowest = TRUE)
pal_usages <- cbind(usages, couleurs_usages)
pal_usages
pal_usages <- cbind(usages, labels(couleurs_usages))
pal_usages
pal_usages <- cbind(usages, levels(couleurs_usages))
levels(couleurs_usages)
pal_usages <- cbind(usages, couleurs_usages)
summary(pal_usages)
pal_usages <- data.frame(usages, couleurs_usages)
pal_usages
dt_pal_usages <- data.frame(usages, couleurs_usages)
dt_pal_usages[,1]
dt_pal_usages[,2]
pal_usages <- scale_color_manual(values=dt_pal_usages[,1]=dt_pal_usages[,2])
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2], color=AFC$col$usages), #choix des composantes i et j
shape=16,
size=7)+
scale_color_manual(values=dt_pal_usages[,1]=dt_pal_usages[,2])
names(couleurs_usages) <- usages
couleurs_usages
ggplot()+
# geom_hline(aes(yintercept=0), colour="gray25")+
# geom_vline(aes(xintercept=0), colour="gray25")+
# labs(title="titre",
#      subtitle="soustitre",
#      x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
#      y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
#      caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
# )+
# # élargissement des limites du plot
# expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# # points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2], color=AFC$col$usages), #choix des composantes i et j
shape=16,
size=7,
colour=couleurs_usages)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_var),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(data=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2], color=AFC$col$usages), #choix des composantes i et j
shape=16,
size=7,
colour=couleurs_usages)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_var),
colour="white",
fontface="bold")+
# lignes reliant les individus
geom_path(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
linetype="dotted",
colour= "gray18")+ #bcp trop compliqué de faire une line avec gradient
#label des individus
geom_text_repel(data=lab_periode,
mapping=aes(x=lab_periode[,axe1], y=lab_periode[,axe2],label=rownames(lab_periode)),
force=2,
# max.iter = 1000,
box.padding = unit(0.4, "lines"),
size=3,
colour=color_ramp_ind(nrow(lab_periode)),
segment.color="grey60")+
#points des individsu
geom_point(data=AFC$li,
mapping=aes(x=AFC$li[,axe1], y=AFC$li[,axe2]),
shape=18,
size=4,
colour= color_ramp_ind(nrow(AFC$li)))+
theme_fivethirtyeight()+
theme_ln()
runApp()
biplot
biplot <-
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)
biplot
biplot <-
ggplot()+
geom_hline(aes(yintercept=0), colour="gray25")+
geom_vline(aes(xintercept=0), colour="gray25")+
labs(title="titre",
subtitle="soustitre",
x=paste("Composante n°", axe1, " (",pctvar_A1, "% de variance expliquée)", sep=""),
y=paste("Composante n°", axe2," (",pctvar_A2, "% de variance expliquée)", sep=""),
caption="L. Nahassia, Géographie-cité, 2018 | Sources : ToToPI, LAT, CITERES"
)+
# élargissement des limites du plot
expand_limits(x=c(min(AFC$li[,axe1])-0.1, max(AFC$li[,axe1])+0.1), y=c(min(AFC$li[,axe2])-0.1, max(AFC$li[,axe2])))+
# points des variables
geom_point(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2]), #choix des composantes i et j
shape=16,
size=7,
colour=palette)+
#labels variables
geom_text(data=AFC$co,
mapping=aes(x=AFC$co[,axe1], y=AFC$co[,axe2],label=liste_var),
colour="white",
fontface="bold")
biplot
runApp()
biplot
runApp()
runApp()
runApp()
reacAFC$variable
reacAFC$variable
reacAFC$data
install.packages("data.table")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
