{
    "collab_server" : "",
    "contents" : "################################\n# Shiny app pour afficher les objets selon le temps\n# L. Nahassia, mai 2018\n# UI pour explOH_11\n################################\nlibrary(shiny)\nlibrary(leaflet)\n\n\n#define UI\nshinyUI(\n  \n  dashboardPage(\n    skin=\"black\",\n    \n    #titre\n    dashboardHeader(\n      title=NULL,\n      titleWidth = 0),\n    \n    dashboardSidebar(\n      width=155,\n      sidebarMenu(\n        menuItem(\"analyse factorielle\", tabName=\"afc\", icon=icon(\"sort-by-attributes-alt\", lib = \"glyphicon\")),\n        menuItem(\"exploration\", tabName=\"explo_carte\", icon = icon(\"search\")),\n        menuItem(\"informations\", tabName =\"info\", icon=icon(\"info\"))\n      )\n    ),\n    \n    dashboardBody(\n      \n      tags$head(tags$link(rel=\"icon\", type=\"image/png\", href=\"favicon.png\"),\n                tags$link(rel=\"stylesheet\", type=\"text/css\", href=\"https://fonts.googleapis.com/css?family=Roboto\"),\n                tags$link(rel=\"stylesheet\", type=\"text/css\", href=\"https://fonts.googleapis.com/css?family=Josefin+Sans:400,600,700\"),\n                tags$script(src =\"https://rawgit.com/rowanwins/leaflet-easyPrint/gh-pages/dist/bundle.js\"),\n                tags$title(\"explOH\"),\n                includeCSS(\"www/style.css\")\n                #attention pas d'accent dans le css > erreur utf\n      ),\n      \n      useShinyjs(),\n      \n      tabItems(\n        tabItem(tabName=\"explo_carte\",\n                #------------------------------- 1. exploration ------------------\n                fluidRow(\n                  #curseur années\n                  box (\n                    id=\"temps_play\",\n                    width=9,\n                    height = 128,\n                    # slide temps\n                    sliderInput(\"limites\", label=\"\",\n                                min=-25, max=2015, value=c(-25, -25), round = 1, step=10, sep=\" \",\n                                animate = animationOptions(interval=1500))\n                  ),#fin curseur années\n                  \n                  \n                  #bornes temporelles\n                  box (\n                    id=\"menu_temps\",\n                    width=3,\n                    splitLayout(\n                      textInput(\"borne_temps_1\", label =\"année min\", value = NULL),\n                      textInput(\"borne_temps_2\", label=\"année max\", value = NULL)\n                    ),\n                    actionButton(\"selec_bornes_temps\", label=\"Appliquer les bornes\")\n                  )#fin menu bornes temps\n                ),#fin fluidRow temps\n                \n                \n                #carte et affichage\n                fluidRow(\n                  \n                  #carte\n                  column(\n                    id=\"map_col\",\n                    width=9,\n                    leafletOutput(\"map\", height = \"600px\")\n                  ),#fin carte\n                  \n                  \n                  #affichage\n                  box(\n                    id=\"affichage_OH\",\n                    width=3,\n                    title=\"affichage des OH\",\n                    #selection valeurs d'usage\n                    tags$span(\"Affichage des différents types d'activités :\"),\n                    br(),br(),\n                    # fonctions à afficher\n                    lapply(1:6, function(i) {\n                      pickerInput(\n                        inputId = paste(\"picker_vurb\", i, sep=\"_\"),\n                        # label = liste_vurb[i],\n                        choices = liste_vusage[substring(liste_vusage,1,2) < i*10+10 & substring(liste_vusage,1,2) >= i*10],\n                        selected = liste_vusage[substring(liste_vusage,1,2) < i*10+10 & substring(liste_vusage,1,2) >= i*10],\n                        multiple = TRUE,\n                        options = list(\n                          `selected-text-format` = \"count>-1\",\n                          `count-selected-text` = paste(liste_vurb[i],\"[{0}/{1}]\", sep=\" \"),\n                          `actions-box` = TRUE,\n                          `deselect-all-text` = \"Aucune\",\n                          `select-all-text` = \"Toutes\",\n                          # `none-Selected-Text` =paste(liste_vurb[i],\"(0/{1} activités)\", sep=\" \"),\n                          `live-Search` = TRUE,\n                          style = paste(\"btn-\",i, sep=\"\")\n                        )\n                      )\n                    } ),#fin sélection valeurs d'usage\n                    br(),\n                    # couleurs selon fonction, portée ou durée d'existance\n                    tags$span(\"différenciation des OH selon leur :\"),\n                    radioButtons(\"couleur_OH\", label =NULL,\n                                 choices = list(\"activité\" = \"v_urb\", \n                                                \"portée\" = \"portee\",\n                                                \"fiabilité de l'apparition\"=\"fiab\"), \n                                 selected = \"v_urb\",\n                                 inline = TRUE)\n                  ), #fin affichage\n                  \n                  \n                  #identification\n                  box(\n                    id=\"id_OH\",\n                    width=3,\n                    title=\"identification des OH\",\n                    #trouver OF\n                    searchInput(\"selec_OH\", \n                                label=NULL,\n                                placeholder= \"Entrer un n° d'OH à trouver\", \n                                btnSearch = icon(\"search\"),\n                                btnReset = icon(\"remove\"))\n                  )#fin identification\n                  \n                  \n                  \n                  \n                ), #fin fluidrow carte, affichage, identification\n                \n                \n                fluidRow(\n                  #téléchargement\n                  box( \n                    id=\"menu_dl\",\n                    width=2,\n                    title =\"téléchargement des OH\",\n                    downloadButton(\"downloadData\", label=\"Télécharger les OH\"),\n                    selectInput(\"type_dl\", \"Type de fichier:\", choices = c(\"geojson\", \"sqlite\",\"csv\"))\n                  ),#fin téléchargement\n                  \n                  #tableau OH\n                  box(\n                    id=\"tableau_OH\",\n                    width=10,\n                    title=\"tableau des OH sélectionnés\",\n                    collapsible = TRUE,\n                    collapsed = TRUE,\n                    dataTableOutput(\"tab_OH\")\n                  )\n                )\n                \n        ),#fin exploration\n        \n        \n        # tags$div(source.signature)\n        \n        \n        #------------------------------ 2. AFC ------------------------\n        tabItem(tabName=\"afc\",\n                fluidRow(\n                  box(\n                    id=\"info_AFC\",\n                    width=12,\n                    solidHeader = TRUE,\n                    tags$span(\"Cet onglet permet d'explorer la structure fonctionnelle et temporelle de l'espace urbain tourangeau à travers des Analyses Factorielles des Correspondances suivie de Classifications Ascendantes Hiérarchiques sur les périodes temporelles. Les AFC sont calculée à partir de tableaux de contingence dénombrant le nombre d'OH selon des périodes temporelles et des caractéristiques fonctionnelles variées. Un commentaire de ces analyses peut être consulté dans le Chapitre 6 de la thèse Nahassia, 2018.\"),\n                    br(),\n                    tags$span(\"Les AFC sont calculées sur toutes les OH disponibles y compris celles n'ayant pas de géométrie (1312 individus).\"),\n                    br(),br(),\n                    tags$span(\"1. onglets bleus : Choix du tableau de contingence\"),br(),\n                    tags$span(\"2. onglets oranges : Résultats de l'AFC - inertie expliquée par chaque axe, graphiques des plans factoriels et tableau des contributions des variables aux axes \"),br(),\n                    tags$span(\"3. onglets rouges : CAH sur les périodes (lignes AFC) - dendrogramme, inertie et caractérisation des classes \")\n                    \n                  )\n                ),#fin info AFC ligne 1\n                #---- ligne 2 : tableau de contingence ----\n                fluidRow( \n                  box(\n                    id=\"choix_periodes\",\n                    width=4,\n                    title= \"choix du tableau de contingence\",\n                    status=\"primary\",\n                    solidHeader = TRUE,\n                    collapsible = TRUE,\n                    column(\n                      width=6,\n                      radioGroupButtons(\n                        label=\"Découpage temporel\",\n                        inputId=\"select_periodes\",\n                        choices=c(\"tous les 25 ans\"=\"25\", \n                                  \"tous les 50 ans\"=\"50\", \n                                  \"tous les 100 ans\"=\"100\", \n                                  \"par périodes historiques\"=\"exp\"),\n                        direction=\"vertical\",\n                        status=\"primary\",\n                        size=\"sm\"\n                      )),#fin colonne temp\n                    column(\n                      width=6,\n                      radioGroupButtons(\n                        label=\"Caractéristiques fonctionnelles\",\n                        inputId=\"select_var\",\n                        choices=c(\"valeurs urbaines\"=\"urb\", \n                                  \"valeurs d'usage\"=\"usage\", \n                                  \"portées\"=\"portee\"),\n                        direction=\"vertical\",\n                        status=\"primary\",\n                        size=\"sm\"\n                      )) #fin colonne var\n                  ), #fin choix tableau\n                  \n                  box(\n                    id=\"affichage_tab_contingence\",\n                    width=8,\n                    title=\"tableau de contingence\",\n                    status=\"primary\",\n                    solidHeader = TRUE,\n                    collapsible = TRUE,\n                    dataTableOutput(\"tab_contingence\")\n                  )# fin tableau de contingence\n                ), # fin ligne 2\n                #---- ligne 3 : AFC ----\n                fluidRow( #ligne 3 AFC\n                  box(\n                    id=\"afc\",\n                    width=12,\n                    title=\"analyse en composante principale\",\n                    status=\"warning\",\n                    solidHeader = TRUE,\n                    collapsible = TRUE,\n                    collapsed=TRUE,\n                    fluidRow( #ligne 3.1 inertie\n                      class=\"box_interne\",\n                      box(\n                        id=\"inertie_axes\",\n                        width=8,\n                        title=\"inertie des axes de l'AFC\",\n                        collapsible = TRUE,\n                        plotOutput(\"plot_inertie_axes\",\n                                   height = \"200px\")\n                      ),\n                      box(\n                        id=\"choix_axes_biplot\",\n                        width=4,\n                        title=\"choix des axes à analyser\",\n                        collapsible = TRUE,\n                        pickerInput(\n                          inputId = \"axe1\",\n                          label=\"Choix du premier axe\",\n                          choices=NULL\n                        ),\n                        pickerInput(\n                          inputId = \"axe2\",\n                          label=\"Choix du deuxième axe\",\n                          choices=NULL\n                        )\n                      )\n                    ), #fin ligne 3.1\n                    \n                    fluidRow(#ligne 3.2 : biplot\n                      class=\"box_interne\",\n                      box(\n                        id=\"biplot\",\n                        width=12,\n                        title=\"biplot des axes sélectionnés\",\n                        collapsible=TRUE,\n                        column(\n                          width=10,\n                          class=\"plot_AFC\",\n                          scatterD3Output(\"plot_biplot\",\n                                          height = \"600px\")\n                        ),\n                        column(\n                          width=2,\n                          tags$span(\"Le bouton des paramètres à droite du graphique permet d'accéder aux options (zoom, enregistrement).\"),\n                          br(), br(),\n                          pickerInput(\n                            inputId = \"masquer_biplot\",\n                            label=\"masquer les lignes ou les colonnes :\",\n                            choices = c(\"aucune\",\"périodes\",\"caractéristiques fonctionnelles\"),\n                            selected = \"aucune\",\n                            multiple=FALSE\n                          )\n                        )\n                        \n                      )\n                      \n                    ),#fin ligne 3.2\n                    \n                    fluidRow( #ligne 3.3. : contributions aux axes\n                      class=\"box_interne\",\n                      box(\n                        id=\"contributions\",\n                        width=12,\n                        title=\"contribution des variables aux axes de l'AFC\",\n                        collapsible=TRUE,\n                        column(\n                          width=6,\n                          class=\"tab_contrib_AFC\",\n                          tags$span(\"Contribution des périodes temporelles\"),\n                          br(),br(),\n                          dataTableOutput(\"contrib_periodes\")\n                        ),\n                        column(\n                          width=6,\n                          class=\"tab_contrib_AFC\",\n                          tags$span(\"Contribution des variables fonctionnelles\"),\n                          br(),br(),\n                          dataTableOutput(\"contrib_variables\")\n                        )\n                      ) #fin box contributions     \n                    ) #fin ligne 3.3.\n                  )),#fin ligne 3\n                #---- ligne 4 : CAH ----\n                fluidRow( \n                  box(\n                    id=\"cah\",\n                    width=12,\n                    title=\"classification ascendante hiérarchique\",\n                    status=\"danger\",\n                    solidHeader = TRUE,\n                    collapsible = TRUE,\n                    tags$span(\"Les CAH sont calculées sur les coordonnées des périodes (lignes) sur toutes les axes de l'AFC, différenciées selon la distance du khi-2. Le poids des lignes est pondéré\"),\n                    br(),br(),# ligne 4.1 choix de la méthode d'aggrégation\n                    awesomeRadio(inputId = \"methode\", \n                                 label = \"Choix de la méthode d'aggrégation \", \n                                 choices = c(\"Ward\"=\"ward.D2\",\"baaezez\"=\"ward.D2\", \"blabalba\"=\"ward.D2\", \"eedqsfsf\"=\"ward.D2\"),\n                                 selected = \"ward.D2\", \n                                 inline = TRUE, checkbox = TRUE, status=\"danger\"),\n                    box(# ligne 4.2 visualisation dendrogramme et inertie des découpages\n                      id=\"choix_nb_classes\",\n                      width=12,\n                      title=\"Résultats de la CAH\",\n                      collapsible = TRUE,\n                      plotOutput(\"plot_dendro\"),\n                      br(),\n                      plotOutput(\"plot_in_cah\",\n                                 height = \"200px\")\n                    ),#fin ligne 4.2\n                    box(#ligne 4.3 caractérisation des classes\n                      id=\"car_classes\",\n                      width=12,\n                      title=\"caractérisation des classes chronologiques\",\n                      footer=\"Chaque classe chronologique est caractérisée par son profil fonctionnel (par valeurs urbaines), en écarts à l'indépendance (/développer/).\",\n                      collapsible = TRUE,\n                      fluidRow(\n                      column(#ligne 4.3.1 choix et frise\n                        id=\"tab_periodes_classes\",\n                        width=2,\n                        pickerInput(\n                          inputId = \"nombre_classes\",\n                          label=\"Nombre de classes à conserver :\",\n                          choices = NULL,\n                          multiple=FALSE,\n                          width=\"auto\",\n                          options=list(size=6)\n                        )\n                      ),\n                      column(\n                        id=\"graph_frise_classes\",\n                        width=10,\n                        plotOutput(\"frise_classes\",\n                                   height = \"110px\")\n                      )),#fin ligne 4.3.1\n                      fluidRow(#ligne 4.3.2 plot des classes\n                      plotOutput(\"plot_classes\")  \n                      )\n                    )#fin ligne 4.3\n                    \n                  ))#fin ligne 4 \n                \n        ), #fin tabAFC\n        \n        #------------------------------- 3. INFO ------------------\n        \n        tabItem(tabName=\"info\",\n                fluidRow( \n                  column(6, source.info),\n                  column (6, source.usage)\n                )\n        )\n      ) #fin tabItems\n      \n    )\n    \n  )\n  \n)\n\n\n",
    "created" : 1531688306502.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2440913158",
    "id" : "C679AD19",
    "lastKnownWriteTime" : 1531688738,
    "last_content_update" : 1531688738789,
    "path" : "D:/Sync/1recherche/1these/SIG/VISU/shiny/explOH_12/ui.r",
    "project_path" : "ui.r",
    "properties" : {
        "docOutlineSize" : "92",
        "docOutlineVisible" : "1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}